<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Escanear códigos de barras</title>
</head>

<body>
    <h1>Escanear códigos de barras</h1>

    <div id="camera"></div>
    <div id="result"></div>

    <button id="startButton">Iniciar escaneo</button>
    <button id="stopButton">Detener escaneo</button>

    <script src="https://unpkg.com/@zxing/library@0.19.0"></script>
    <script>
        let codeReader;

        document.getElementById('startButton').addEventListener('click', startBarcodeScanner);
        document.getElementById('stopButton').addEventListener('click', stopBarcodeScanner);

        function startBarcodeScanner() {
            const video = document.createElement('video');
            const resultDiv = document.getElementById('result');
            document.body.appendChild(video);

            codeReader = new ZXing.BrowserBarcodeReader();
            codeReader.listVideoInputDevices()
                .then((videoInputDevices) => {
                    if (videoInputDevices.length > 0) {
                        codeReader.decodeFromInputVideoDevice(videoInputDevices[0].deviceId, 'video')
                            .then((result) => {
                                resultDiv.textContent = result.text;
                            })
                            .catch((err) => {
                                console.error(err);
                            });
                    } else {
                        console.error('No se encontraron dispositivos de video');
                    }
                })
                .catch((err) => {
                    console.error(err);
                });
        }

        function stopBarcodeScanner() {
            codeReader.stopStreams();
            const video = document.querySelector('video');
            video.pause();
            video.srcObject.getTracks().forEach(track => track.stop());
            document.body.removeChild(video);
            document.getElementById('result').textContent = '';
        }
    </script>
</body>

</html>
